function rectangle(){return{perimeter:function(e,t){return 2*(Number(e)+Number(t))},area:function(e,t){return Number(e)*Number(t)}}}function valid(e){var t={isOk:!1,reason:""};return""===e?t.reason="不能为空":Number(e)<0?t.reason="不能为负数":/^-?(0|[1-9]\d*)(\.\d*)?([eE][+-]?\d+)?$/.test(e)?t.isOk=!0:t.reason="不是合法数字",t}function isLegalKey(e,t,r){if(/[abcdf-zABCDF-Z`~!@#$%^&*()\-=_+[\]{}|;:'",<>/?\\]/.test(e))return!1;if("."===e){if(0===r||-1!==t.indexOf("."))return!1;if(1===r&&"-"===t.substring(0,1))return!1}if("e"===e){if(0===r||-1!==t.indexOf("e")||-1!==t.indexOf("E"))return!1;if(1===r&&"-"===t.substring(0,1))return!1}if("E"===e){if(0===r||-1!==t.indexOf("e")||-1!==t.indexOf("E"))return!1;if(1===r&&"-"===t.substring(0,1))return!1}return!0}$(function(){var a=$("#width"),u=$("#height"),e=$("#calculate"),l=$("#perimeter"),s=$("#area"),f=$("#width-validation"),o=$("#height-validation");a.keypress(function(e){isLegalKey(e.key,e.target.value,e.target.selectionStart)||e.preventDefault()}),a.focusout(function(){var e=valid(a.val());if(!e.isOk)return f.html("宽度"+e.reason),void a.select();f.html("")}),u.keypress(function(e){isLegalKey(e.key,e.target.value,e.target.selectionStart)||e.preventDefault()}),u.focusout(function(){var e=valid(u.val());if(!e.isOk)return o.html("高度"+e.reason),void u.select();o.html("")}),e.click(function(){var e=a.val(),t=u.val(),r=valid(e),i=valid(t);if(!r.isOk)return f.html("宽度"+r.reason),void a.select();if(!i.isOk)return o.html("高度"+i.reason),void u.select();f.html(""),o.html("");var n=rectangle();l.val(n.perimeter(e,t)),s.val(n.area(e,t))}),e.mousedown(function(e){e.preventDefault()})});